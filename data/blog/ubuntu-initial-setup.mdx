---
title: 'My Initial Server Setup Guide for Ubuntu'
summary: 'My initial configuration I set up on an Ubuntu server.'
publishedAt: '2020-11-25'
image: '/static/images/blog/ubuntu-setup/ubuntu-setup-header.png'
---

# Configuring Ubuntu Server

- ## Adding a non-root user

```shell
$ adduser <newuser>
```

Granting a User Sudo Privileges:

```shell
$ usermod -aG sudo <newuser>
```

see a User groups:

```shell
$ groups <newuser>
```

- ## Setting Up a Basic Firewall

  UFW is installed by default on Ubuntu. If it has been uninstalled for some reason, you can install it with `sudo apt install ufw`

> Different applications can register their profiles with UFW upon installation. These profiles allow UFW to manage these applications by name. OpenSSH, the service allowing us to connect to our server now, has a profile registered with UFW. You can see this by typing:

```shell
$ sudo ufw app list
```

allowing different ports and connection (including ssh connection for and default ssh port so the we can log back in )

```shell
$ ufw allow OpenSSH
$ ufw allow ssh
$ ufw allow http
$ ufw allow https
$ ufwallow <default ssh port>
```

Afterwards, we can enable the firewall by typing:

```shell
$ sudo ufw enable
```

check UFW status by:

```shell
$ sudo ufw status vebose
```

- ## Adding SSH key authentication

  > We're adding the ssh key authentication to the non-root user account. so make sure you are logged in as a non-root user'

  > For the purpose of this tutorial, We will assume the following information, but you should replace this with your own info and settings.
  >
  > Server IP address: `100.200.30.40`
  >
  > Port: `3031`
  >
  > non-root user: `amirsolo`

  **1- Generate private/public ssh key on your local machine**

  ```shell
  $ ssh-keygen -t rsa -b 4096
  ```

  When entering the file name, You can specify a new name (for example "custom_name").

  It's going to ask for the password (leave empty if you don't wanna set pasphrase).

  **2- make .ssh directory in home directory (/home/username)**

  ```shell
  $ cd
  $ mkdir .ssh
  ```

  **3- Copy publck key to the remote machine (Ubuntu)**

  > `scp` (secure copy) is a command-line utility that allows you to securely copy files and directories between two locations.

  ```shell
  $ scp -P 3031 ~/.ssh/custom_name.pub amirsolo@100.200.30.40:/home/amirsolo/.ssh/public_key.pub
  ```

  **3- Create "authorized_keys" file inside .ssh directory**

  > `cat` command will automatically create the file

  ```shell
  $ cat ~/.ssh/public_key.pub >> ~/.ssh/authorized_keys
  ```

  **3- Setting up permissions correctly**

  ```shell
  $ chmod 700 ~/.ssh/
  ```

  ```shell
  $ chmod 600 ~/.ssh/*
  ```

  **3- Edit ssh config file on local machine**

  go to `~/.ssh` directory on your local machine and edit the `config` file like this. (create if doesn't exit)

  ```
  Host myserver
  	HostName 100.200.30.40
      Port 3031
  	User amir
  	IdentityFile ~/.ssh/custom_name
  	UseKeychain yes
  ```

  **Now you can login to your server without the need of password.**

> **_To know more about `~/.ssh/config` file, visist [here](https://askubuntu.com/questions/30788/does-ssh-key-need-to-be-named-id-rsa/30792#30792)_**

---

- [How to Add and Delete Users on Ubuntu 18.04](https://www.digitalocean.com/community/tutorials/how-to-add-and-delete-users-on-ubuntu-18-04)
- [Initial Server Setup with Ubuntu](https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04)
- [How To Set Up a Firewall with UFW on Ubuntu](https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-with-ufw-on-ubuntu-18-04)
- [YT tutorial: Setting up SSH key-based Authentication](https://www.youtube.com/watch?v=vpk_1gldOAE)
- [The Ultimate Guide to SSH](https://www.freecodecamp.org/news/the-ultimate-guide-to-ssh-setting-up-ssh-keys/)
- [Setting other custom name for ssh key](https://askubuntu.com/questions/30788/does-ssh-key-need-to-be-named-id-rsa)
